SELECT Body AS b, simpleJSONExtractInt(Body, 'type') AS t, LogAttributes['rr-web.chunk'] AS ck, LogAttributes['rr-web.total-chunks'] AS tcks FROM otel_v2.hyperdx_sessions WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((ServiceName = 'frontend') AND ((ResourceAttributes['rum.sessionId']) = '3ba5ec704cce0df5eef6150ad480ed77')) ORDER BY TimestampTime ASC LIMIT _CAST(0, 'Int32'), _CAST(1000000, 'Int32') 
SELECT Body AS Body, Timestamp AS Timestamp, SpanId AS SpanId, ServiceName AS ServiceName, SeverityText AS SeverityText FROM otel_v2.otel_logs WHERE ((Timestamp > fromUnixTimestamp64Milli(_CAST(1750252038141, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (TraceId = 'c16dca9859531d08f6cae3f9258e98dc') LIMIT _CAST(0, 'Int32'), _CAST(10000, 'Int32')  
SELECT Body AS Body, Timestamp AS Timestamp, SpanId AS SpanId, ServiceName AS ServiceName, SeverityText AS SeverityText FROM otel_v2.otel_logs WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (TraceId = 'c16dca9859531d08f6cae3f9258e98dc') LIMIT _CAST(0, 'Int32'), _CAST(10000, 'Int32')  
SELECT concat(SpanName, ' ', if(has(['HTTP DELETE', 'DELETE', 'HTTP GET', 'GET', 'HTTP HEAD', 'HEAD', 'HTTP OPTIONS', 'OPTIONS', 'HTTP PATCH', 'PATCH', 'HTTP POST', 'POST', 'HTTP PUT', 'PUT'], SpanName), COALESCE(NULLIF(SpanAttributes['server.address'], ''), NULLIF(SpanAttributes['http.host'], '')), '')) AS group, SUM(toFloat64OrDefault(toString(Duration / 1000000.))) AS `Total Time Spent`, count() AS `Number of Calls`, AVG(toFloat64OrDefault(toString(Duration / 1000000.))) AS `Average Duration`, MIN(toFloat64OrDefault(toString(Duration / 1000000.))) AS `Min Duration`, MAX(toFloat64OrDefault(toString(Duration / 1000000.))) AS `Max Duration`, COUNTDistinct(TraceId) AS `Number of Requests`, `Number of Calls` / `Average Duration` AS `Calls per Request` FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((TraceId IN (SELECT DISTINCT TraceId FROM otel_v2.otel_traces WHERE (SpanName = 'POST /oteldemo.CartService/AddItem') AND (Timestamp >= fromUnixTimestamp64Milli(1750249396909)) AND (Timestamp <= fromUnixTimestamp64Milli(1750252996909)))) AND ((Duration >= 0) AND (SpanName != 'POST /oteldemo.CartService/AddItem'))) GROUP BY group ORDER BY `Total Time Spent` DESC LIMIT _CAST(200, 'Int32')
SELECT count() AS Requests, toStartOfInterval(toDateTime(Timestamp), toIntervalMinute(1)) AS __hdx_time_bucket FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((SpanName = 'POST /oteldemo.CartService/AddItem') AND (SpanKind IN ('Server', 'SPAN_KIND_SERVER'))) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT count() AS Requests, toStartOfInterval(toDateTime(Timestamp), toIntervalMinute(1)) AS __hdx_time_bucket FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (SpanKind IN ('Server', 'SPAN_KIND_SERVER')) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT count(), SeverityText, toStartOfInterval(toDateTime(TimestampTime), toIntervalMinute(30)) AS __hdx_time_bucket FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((SeverityText IN ('error')) AND (ServiceName IN ('payment'))) GROUP BY SeverityText, __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT count(), SeverityText, toStartOfInterval(toDateTime(TimestampTime), toIntervalSecond(15)) AS __hdx_time_bucket FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (SeverityText IN ('error')) GROUP BY SeverityText, __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT count(), SeverityText, toStartOfInterval(toDateTime(TimestampTime), toIntervalSecond(15)) AS __hdx_time_bucket FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((SeverityText IN ('error')) AND (ServiceName IN ('payment'))) GROUP BY SeverityText, __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT count(), SeverityText, toStartOfInterval(toDateTime(TimestampTime), toIntervalSecond(15)) AS __hdx_time_bucket FROM otel_v2.otel_logs WHERE (TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY SeverityText, __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT count(), StatusCode, toStartOfInterval(toDateTime(Timestamp), toIntervalMinute(30)) AS __hdx_time_bucket FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (ServiceName IN ('payment')) GROUP BY StatusCode, __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT count(), StatusCode, toStartOfInterval(toDateTime(Timestamp), toIntervalMinute(30)) AS __hdx_time_bucket FROM otel_v2.otel_traces WHERE (Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY StatusCode, __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT count(), StatusCode, toStartOfInterval(toDateTime(Timestamp), toIntervalSecond(15)) AS __hdx_time_bucket FROM otel_v2.otel_traces WHERE (Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY StatusCode, __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT countIf(lower(Body) LIKE lower('%error%')), toStartOfInterval(toDateTime(TimestampTime), toIntervalHour(6)) AS __hdx_time_bucket FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (lower(Body) LIKE lower('%error%')) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT countIf(lower(Body) LIKE lower('%error%')), toStartOfInterval(toDateTime(TimestampTime), toIntervalMinute(5)) AS __hdx_time_bucket FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (lower(Body) LIKE lower('%error%')) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT countIf(lower(Body) LIKE lower('%error%')), toStartOfInterval(toDateTime(TimestampTime), toIntervalSecond(15)) AS __hdx_time_bucket FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (lower(Body) LIKE lower('%error%')) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT countIf(lower(StatusCode) = 'error') / count() AS `Error Rate %`, toStartOfInterval(toDateTime(Timestamp), toIntervalMinute(1)) AS __hdx_time_bucket FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (((SpanAttributes['http.scheme']) = 'http') AND (SpanKind IN ('Server', 'SPAN_KIND_SERVER'))) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT countIf(lower(StatusCode) = 'error') / count() AS `Error Rate %`, toStartOfInterval(toDateTime(Timestamp), toIntervalMinute(1)) AS __hdx_time_bucket FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (((SpanName = 'POST /oteldemo.CartService/AddItem') AND (SpanKind IN ('Server', 'SPAN_KIND_SERVER'))) AND ((SpanAttributes['http.scheme']) = 'http')) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT countIf(ServiceName = 'valkey-cart'), toStartOfInterval(toDateTime(TimestampTime), toIntervalHour(1)) AS __hdx_time_bucket FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (ServiceName = 'valkey-cart') GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT countIf(ServiceName = 'valkey-cart'), toStartOfInterval(toDateTime(TimestampTime), toIntervalMinute(30)) AS __hdx_time_bucket FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (ServiceName = 'valkey-cart') GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT DISTINCT lowCardinalityKeys(arrayJoin(Attributes.keys)) AS key FROM otel_v2.otel_metrics_gauge LIMIT _CAST(1000, 'Int32') 
SELECT DISTINCT lowCardinalityKeys(arrayJoin(Attributes.keys)) AS key FROM otel_v2.otel_metrics_gauge WHERE MetricName = 'visa_validation_cache.size' LIMIT _CAST(1000, 'Int32') 
SELECT DISTINCT lowCardinalityKeys(arrayJoin(LogAttributes.keys)) AS key FROM otel_v2.otel_logs LIMIT _CAST(1000, 'Int32') 
SELECT DISTINCT lowCardinalityKeys(arrayJoin(ResourceAttributes.keys)) AS key FROM otel_v2.otel_logs LIMIT _CAST(1000, 'Int32') 
SELECT DISTINCT lowCardinalityKeys(arrayJoin(ResourceAttributes.keys)) AS key FROM otel_v2.otel_metrics_gauge LIMIT _CAST(1000, 'Int32') 
SELECT DISTINCT lowCardinalityKeys(arrayJoin(ResourceAttributes.keys)) AS key FROM otel_v2.otel_metrics_gauge WHERE MetricName = 'visa_validation_cache.size' LIMIT _CAST(1000, 'Int32') 
SELECT DISTINCT lowCardinalityKeys(arrayJoin(ResourceAttributes.keys)) AS key FROM otel_v2.otel_traces LIMIT _CAST(1000, 'Int32') 
SELECT DISTINCT lowCardinalityKeys(arrayJoin(ScopeAttributes.keys)) AS key FROM otel_v2.otel_logs LIMIT _CAST(1000, 'Int32') 
SELECT DISTINCT lowCardinalityKeys(arrayJoin(ScopeAttributes.keys)) AS key FROM otel_v2.otel_metrics_gauge LIMIT _CAST(1000, 'Int32') 
SELECT DISTINCT lowCardinalityKeys(arrayJoin(ScopeAttributes.keys)) AS key FROM otel_v2.otel_metrics_gauge WHERE MetricName = 'visa_validation_cache.size' LIMIT _CAST(1000, 'Int32') 
SELECT DISTINCT lowCardinalityKeys(arrayJoin(SpanAttributes.keys)) AS key FROM otel_v2.otel_traces LIMIT _CAST(1000, 'Int32') 
SELECT DISTINCT ScopeAttributes, ResourceAttributes, Attributes FROM otel_v2.otel_metrics_gauge WHERE MetricName = 'visa_validation_cache.size' LIMIT _CAST(10000, 'Int32') 
SELECT DISTINCT ServiceName AS service FROM otel_v2.otel_logs WHERE ServiceName IS NOT NULL LIMIT _CAST(200, 'Int32') 
SELECT DISTINCT ServiceName AS service FROM otel_v2.otel_traces WHERE ServiceName IS NOT NULL LIMIT _CAST(200, 'Int32') 
SELECT groupUniqArray(20)(ResourceAttributes['k8s.cluster.name']) AS param0 FROM otel_v2.otel_metrics_gauge WHERE (TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) 
SELECT groupUniqArray(20)(ServiceName) AS param0 FROM otel_v2.otel_logs 
SELECT groupUniqArray(20)(SeverityText) AS param0, groupUniqArray(20)(ServiceName) AS param1, groupUniqArray(20)(ResourceSchemaUrl) AS param2, groupUniqArray(20)(ScopeSchemaUrl) AS param3, groupUniqArray(20)(ScopeVersion) AS param4 FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((SeverityText IN ('error')) AND (ServiceName IN ('payment'))) 
SELECT groupUniqArray(20)(SeverityText) AS param0, groupUniqArray(20)(ServiceName) AS param1, groupUniqArray(20)(ResourceSchemaUrl) AS param2, groupUniqArray(20)(ScopeSchemaUrl) AS param3, groupUniqArray(20)(ScopeVersion) AS param4 FROM otel_v2.otel_logs WHERE (TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) 
SELECT groupUniqArray(20)(SpanAttributes['userEmail']) AS param0 FROM otel_v2.otel_traces 
SELECT groupUniqArray(20)(SpanName) AS param0, groupUniqArray(20)(SpanKind) AS param1, groupUniqArray(20)(ServiceName) AS param2, groupUniqArray(20)(StatusCode) AS param3 FROM otel_v2.otel_traces WHERE (Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) 
SELECT groupUniqArray(3000)(MetricName) AS param0 FROM otel_v2.otel_metrics_gauge WHERE (TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) 
SELECT groupUniqArray(3000)(MetricName) AS param0 FROM otel_v2.otel_metrics_histogram WHERE (TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) 
SELECT groupUniqArray(3000)(MetricName) AS param0 FROM otel_v2.otel_metrics_sum WHERE (TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) 
SELECT quantile(0.95)(toFloat64OrDefault(toString(Duration / 1000000.))) AS `95th Percentile`, quantile(0.5)(toFloat64OrDefault(toString(Duration / 1000000.))) AS Median, AVG(toFloat64OrDefault(toString(Duration / 1000000.))) AS Avg, toStartOfInterval(toDateTime(Timestamp), toIntervalMinute(1)) AS __hdx_time_bucket FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (((SpanName = 'POST /oteldemo.CartService/AddItem') AND (SpanKind IN ('Server', 'SPAN_KIND_SERVER'))) AND (SpanKind IN ('Server', 'SPAN_KIND_SERVER'))) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT quantile(0.95)(toFloat64OrDefault(toString(Duration / 1000000.))) AS `95th Percentile`, quantile(0.5)(toFloat64OrDefault(toString(Duration / 1000000.))) AS Median, AVG(toFloat64OrDefault(toString(Duration / 1000000.))) AS Avg, toStartOfInterval(toDateTime(Timestamp), toIntervalMinute(1)) AS __hdx_time_bucket FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (SpanKind IN ('Server', 'SPAN_KIND_SERVER')) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
SELECT quantile(0.95)(toFloat64OrDefault(toString(Duration / 1000000.))) AS p95 FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((SpanName = 'POST /oteldemo.CartService/AddItem') AND (SpanKind IN ('Server', 'SPAN_KIND_SERVER'))) 
SELECT SpanAttributes['message'] AS body, SpanAttributes['component'] AS component, (toFloat64OrZero(toString(Duration)) * pow(10, 3)) / pow(10, toInt8OrZero(toString(9))) AS durationInMs, SpanAttributes['error.message'] AS `error.message`, SpanAttributes['http.method'] AS `http.method`, SpanAttributes['http.status_code'] AS `http.status_code`, SpanAttributes['http.url'] AS `http.url`, cityHash64(TraceId, ParentSpanId, SpanId, Timestamp) AS id, SpanAttributes['location.href'] AS `location.href`, ScopeName AS `otel.library.name`, ParentSpanId AS parent_span_id, StatusCode AS severity_text, SpanId AS span_id, SpanName AS span_name, Timestamp AS timestamp, TraceId AS trace_id, CAST('span', 'String') AS type FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (((ResourceAttributes['rum.sessionId']) = '3ba5ec704cce0df5eef6150ad480ed77') AND (((SpanAttributes['http.status_code']) > '299') OR ((SpanAttributes['component']) = 'error') OR (SpanName = 'routeChange') OR (SpanName = 'documentLoad') OR (SpanName = 'intercom.onShow') OR (ScopeName = 'custom-action'))) ORDER BY Timestamp ASC LIMIT _CAST(0, 'Int32'), _CAST(4000, 'Int32') 
SELECT SpanName AS Body, Timestamp AS Timestamp, SpanId AS SpanId, ServiceName AS ServiceName, Duration / 1000000000. AS Duration, ParentSpanId AS ParentSpanId, StatusCode AS StatusCode, SpanAttributes AS SpanAttributes FROM otel_v2.otel_traces WHERE ((Timestamp > fromUnixTimestamp64Milli(_CAST(1750252038141, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (TraceId = 'c16dca9859531d08f6cae3f9258e98dc') LIMIT _CAST(0, 'Int32'), _CAST(10000, 'Int32')  
SELECT SpanName AS Body, Timestamp AS Timestamp, SpanId AS SpanId, ServiceName AS ServiceName, Duration / 1000000000. AS Duration, ParentSpanId AS ParentSpanId, StatusCode AS StatusCode, SpanAttributes AS SpanAttributes FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (TraceId = 'c16dca9859531d08f6cae3f9258e98dc') LIMIT _CAST(0, 'Int32'), _CAST(10000, 'Int32')  
SELECT SpanName AS Endpoint, round(count() / age('mi', toDateTime(1750249396.909), toDateTime(1750252996.909)), 1) AS `Req/Min`, round(quantile(0.95)(Duration / 1000000.), 2) AS `P95 (ms)`, round(quantile(0.5)(Duration / 1000000.), 2) AS `Median (ms)`, round(SUM(Duration / 1000000.), 2) AS `Total (ms)`, round(countIf(lower(StatusCode) = 'error') / age('mi', toDateTime(1750249396.909), toDateTime(1750252996.909)), 1) AS `Errors/Min` FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (SpanKind IN ('Server', 'SPAN_KIND_SERVER')) GROUP BY SpanName ORDER BY SpanName ASC LIMIT _CAST(0, 'Int32'), _CAST(200, 'Int32')  
SELECT SpanName AS Endpoint, SUM(toFloat64OrDefault(toString(Duration / 1000000.))) AS `Total (ms)`, count() / age('mi', toDateTime(1750249396.909), toDateTime(1750252996.909)) AS `Req/Min`, quantile(0.5)(toFloat64OrDefault(toString(Duration / 1000000.))) AS `P95 (ms)`, quantile(0.95)(toFloat64OrDefault(toString(Duration / 1000000.))) AS `Median (ms)`, countIf(lower(StatusCode) = 'error') / age('mi', toDateTime(1750249396.909), toDateTime(1750252996.909)) AS `Errors/Min` FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (SpanKind IN ('Server', 'SPAN_KIND_SERVER')) GROUP BY SpanName ORDER BY `Total (ms)` DESC 
SELECT Timestamp AS Timestamp, ResourceAttributes['rum.sessionId'] AS rumSessionId, ResourceAttributes['service.name'] AS serviceName, ParentSpanId AS parentSpanId FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (TraceId = 'c16dca9859531d08f6cae3f9258e98dc') LIMIT _CAST(0, 'Int32'), _CAST(10000, 'Int32')  
SELECT Timestamp AS timestamp, ServiceName AS _service, generateUUIDv4() AS id, JSONExtractString(Body, 'object', 'metadata', 'creationTimestamp') AS `object.metadata.creationTimestamp`, JSONExtractString(Body, 'object', 'reason') AS `object.reason`, JSONExtractString(Body, 'object', 'note') AS `object.note`, JSONExtractString(Body, 'object', 'type') AS `object.type`, JSONExtractString(Body, 'object', 'message') AS `object.message`, JSONExtractString(Body, 'object', 'regarding', 'name') AS `k8s.pod.name`, JSONExtractString(Body, 'object', 'regarding', 'uid') AS `k8s.pod.uid`, JSONExtractString(Body, 'type') AS type, JSONExtractString(Body, 'object', 'type') AS severity_text, JSONExtractString(Body, 'object', 'note') AS body FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (((LogAttributes['k8s.resource.name']) = 'events') AND (`k8s.pod.uid` = '5e02b5fb-13ae-4296-bbbc-111f423c460d')) ORDER BY TimestampTime DESC LIMIT _CAST(0, 'Int32'), _CAST(50, 'Int32') 
SELECT Timestamp AS Timestamp, StatusCode AS Severity, SpanName AS `Span Name`, Duration / 1000000. AS `Duration (ms)`, Timestamp, ServiceName, SpanName, toDateTime(Timestamp) FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (((SpanName = 'POST /oteldemo.CartService/AddItem') AND (SpanKind IN ('Server', 'SPAN_KIND_SERVER'))) AND ((Duration / 1000000.) > 178)) ORDER BY Duration / 1000000. DESC LIMIT _CAST(0, 'Int32'), _CAST(200, 'Int32')  
SELECT Timestamp, ServiceName, SeverityText, Body, TimestampTime, TimestampTime FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (ServiceName = 'valkey-cart') ORDER BY TimestampTime DESC LIMIT _CAST(0, 'Int32'), _CAST(200, 'Int32')  
SELECT Timestamp, ServiceName, SeverityText, Body, TimestampTime, TimestampTime FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (lower(Body) LIKE lower('%error%')) ORDER BY TimestampTime DESC LIMIT _CAST(0, 'Int32'), _CAST(200, 'Int32')  
SELECT Timestamp, ServiceName, SeverityText, Body, TimestampTime, TimestampTime FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (SeverityText IN ('error')) ORDER BY TimestampTime DESC LIMIT _CAST(0, 'Int32'), _CAST(200, 'Int32')  
SELECT Timestamp, ServiceName, SeverityText, Body, TimestampTime, TimestampTime FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((SeverityText IN ('error')) AND (ServiceName IN ('payment'))) ORDER BY TimestampTime DESC LIMIT _CAST(0, 'Int32'), _CAST(200, 'Int32')  
SELECT Timestamp, ServiceName, SeverityText, Body, TimestampTime, TimestampTime FROM otel_v2.otel_logs WHERE (TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) ORDER BY TimestampTime DESC LIMIT _CAST(0, 'Int32'), _CAST(200, 'Int32')  
SELECT Timestamp, ServiceName, StatusCode, round(Duration / 1000000.), SpanName, toDateTime(Timestamp) FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (ServiceName IN ('payment')) ORDER BY Timestamp DESC LIMIT _CAST(0, 'Int32'), _CAST(200, 'Int32')  
SELECT Timestamp, ServiceName, StatusCode, round(Duration / 1000000.), SpanName, toDateTime(Timestamp) FROM otel_v2.otel_traces WHERE (Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) ORDER BY Timestamp DESC LIMIT _CAST(0, 'Int32'), _CAST(200, 'Int32')  
SELECT TimestampTime AS Timestamp, JSONExtractString(Body, 'object', 'type') AS Severity, JSONExtractString(Body, 'object', 'regarding', 'kind') AS Kind, JSONExtractString(Body, 'object', 'regarding', 'name') AS Name, JSONExtractString(Body, 'object', 'note') AS Message, TimestampTime, ServiceName, TimestampTime FROM otel_v2.otel_logs WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (((LogAttributes['k8s.resource.name']) = 'events') AND (Severity != 'Normal')) ORDER BY TimestampTime DESC LIMIT _CAST(0, 'Int32'), _CAST(200, 'Int32')  
WITH _sessions AS (SELECT ServiceName AS serviceName, ResourceAttributes['rum.sessionId'] AS sessionId, MAX(Timestamp) AS maxTimestamp, MIN(Timestamp) AS minTimestamp, count() AS sessionCount, countIf((SpanAttributes['component']) = 'user-interaction') AS interactionCount, countIf(StatusCode ILIKE '%error%') AS errorCount, countIf(SpanName = 'record init') AS recordingCount, MAX(SpanAttributes['teamId']) AS teamId, MAX(SpanAttributes['teamName']) AS teamName, MAX(SpanAttributes['userEmail']) AS userEmail, MAX(SpanAttributes['userName']) AS userName, serviceName, sessionId FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND mapContains(ResourceAttributes, 'rum.sessionId') GROUP BY serviceName, sessionId), sessions AS (SELECT * FROM _sessions HAVING (interactionCount > 0) OR (recordingCount > 0) ORDER BY maxTimestamp DESC LIMIT 500) SELECT * FROM sessions 
WITH _sessions AS (SELECT ServiceName AS serviceName, ResourceAttributes['rum.sessionId'] AS sessionId, MAX(Timestamp) AS maxTimestamp, MIN(Timestamp) AS minTimestamp, count() AS sessionCount, countIf((SpanAttributes['component']) = 'user-interaction') AS interactionCount, countIf(StatusCode ILIKE '%error%') AS errorCount, countIf(SpanName = 'record init') AS recordingCount, MAX(SpanAttributes['teamId']) AS teamId, MAX(SpanAttributes['teamName']) AS teamName, MAX(SpanAttributes['userEmail']) AS userEmail, MAX(SpanAttributes['userName']) AS userName, serviceName, sessionId FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND mapContains(ResourceAttributes, 'rum.sessionId') AND (notEmpty(SpanAttributes['userEmail']) = 1) GROUP BY serviceName, sessionId), sessions AS (SELECT * FROM _sessions ORDER BY maxTimestamp DESC LIMIT 500), sessionIdsWithRecordings AS (SELECT DISTINCT ResourceAttributes['rum.sessionId'] AS sessionId FROM otel_v2.hyperdx_sessions WHERE ((TimestampTime >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimestampTime <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((ResourceAttributes['rum.sessionId']) IN (SELECT sessions.sessionId FROM sessions))), sessionIdsWithUserActivity AS (SELECT DISTINCT ResourceAttributes['rum.sessionId'] AS sessionId FROM otel_v2.otel_traces WHERE ((Timestamp >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (Timestamp <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (((SpanName = 'record init') OR (SpanName = 'visibility')) AND ((ResourceAttributes['rum.sessionId']) IN (SELECT sessions.sessionId FROM sessions)))) SELECT * FROM sessions WHERE (sessions.sessionId IN (SELECT sessionIdsWithRecordings.sessionId FROM sessionIdsWithRecordings)) OR (sessions.sessionId IN (SELECT sessionIdsWithUserActivity.sessionId FROM sessionIdsWithUserActivity)) 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'visa_validation_cache.size')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(30)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT max(toFloat64OrDefault(toString(LastValue))) AS `max(visa_validation_cache.size)`, toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalMinute(30)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.pod.cpu_limit_utilization')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.pod.cpu_limit_utilization)`, ResourceAttributes['k8s.pod.name'], ResourceAttributes['k8s.namespace.name'], ResourceAttributes['k8s.node.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.pod.name'], ResourceAttributes['k8s.namespace.name'], ResourceAttributes['k8s.node.name'] 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.pod.cpu.utilization')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.pod.cpu.utilization)`, ResourceAttributes['k8s.pod.name'], ResourceAttributes['k8s.namespace.name'], ResourceAttributes['k8s.node.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.pod.name'], ResourceAttributes['k8s.namespace.name'], ResourceAttributes['k8s.node.name'] 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.pod.memory.usage')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.pod.memory.usage)`, ResourceAttributes['k8s.pod.name'], ResourceAttributes['k8s.namespace.name'], ResourceAttributes['k8s.node.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.pod.name'], ResourceAttributes['k8s.namespace.name'], ResourceAttributes['k8s.node.name'] 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.pod.phase')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT last_value(toFloat64OrDefault(toString(LastValue))) AS `last_value(k8s.pod.phase)`, ResourceAttributes['k8s.pod.name'], ResourceAttributes['k8s.namespace.name'], ResourceAttributes['k8s.node.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.pod.name'], ResourceAttributes['k8s.namespace.name'], ResourceAttributes['k8s.node.name'] 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.container.restarts')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT last_value(toFloat64OrDefault(toString(LastValue))) AS `last_value(k8s.container.restarts)`, ResourceAttributes['k8s.pod.name'], ResourceAttributes['k8s.namespace.name'], ResourceAttributes['k8s.node.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.pod.name'], ResourceAttributes['k8s.namespace.name'], ResourceAttributes['k8s.node.name'] 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.node.condition_ready')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.node.condition_ready)`, ResourceAttributes['k8s.node.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.node.name'] 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.node.cpu.utilization')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.node.cpu.utilization)`, ResourceAttributes['k8s.node.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.node.name'] 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.node.cpu.utilization')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.node.cpu.utilization)`, ResourceAttributes['k8s.node.name'], toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalMinute(1)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.node.name'], __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.node.memory.usage')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.node.memory.usage)`, ResourceAttributes['k8s.node.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.node.name'] 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.node.memory.usage')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.node.memory.usage)`, ResourceAttributes['k8s.node.name'], toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalMinute(1)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.node.name'], __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.pod.cpu.utilization')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.pod.cpu.utilization)`, ResourceAttributes['k8s.pod.name'], toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalMinute(1)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.pod.name'], __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.pod.cpu.utilization')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT sum(toFloat64OrDefault(toString(LastValue))) AS `sum(k8s.pod.cpu.utilization)`, ResourceAttributes['k8s.namespace.name'], toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalMinute(1)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.namespace.name'], __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.pod.memory.usage')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.pod.memory.usage)`, ResourceAttributes['k8s.pod.name'], toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalMinute(1)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.pod.name'], __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.pod.memory.usage')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT sum(toFloat64OrDefault(toString(LastValue))) AS `sum(k8s.pod.memory.usage)`, ResourceAttributes['k8s.namespace.name'], toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalMinute(1)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.namespace.name'], __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((ResourceAttributes['k8s.pod.uid']) = '5e02b5fb-13ae-4296-bbbc-111f423c460d') AND (MetricName = 'k8s.pod.cpu.utilization')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalSecond(30)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.pod.cpu.utilization)`, toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalSecond(30)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((ResourceAttributes['k8s.pod.uid']) = '5e02b5fb-13ae-4296-bbbc-111f423c460d') AND (MetricName = 'k8s.pod.filesystem.available')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalSecond(30)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.pod.filesystem.available)`, toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalSecond(30)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((ResourceAttributes['k8s.pod.uid']) = '5e02b5fb-13ae-4296-bbbc-111f423c460d') AND (MetricName = 'k8s.pod.memory.usage')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalSecond(30)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.pod.memory.usage)`, toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalSecond(30)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((ResourceAttributes['k8s.node.name']) = 'gke-pme-k8s-standard-main-pool-1dba29d7-95ki') AND (MetricName = 'k8s.node.cpu.utilization')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalSecond(30)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.node.cpu.utilization)`, toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalSecond(30)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((ResourceAttributes['k8s.node.name']) = 'gke-pme-k8s-standard-main-pool-1dba29d7-95ki') AND (MetricName = 'k8s.node.filesystem.available')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalSecond(30)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.node.filesystem.available)`, toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalSecond(30)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND ((ResourceAttributes['k8s.node.name']) = 'gke-pme-k8s-standard-main-pool-1dba29d7-95ki') AND (MetricName = 'k8s.node.memory.usage')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalSecond(30)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT avg(toFloat64OrDefault(toString(LastValue))) AS `avg(k8s.node.memory.usage)`, toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalSecond(30)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'visa_validation_cache.size')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalSecond(15)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT max(toFloat64OrDefault(toString(LastValue))) AS `max(visa_validation_cache.size)`, toStartOfInterval(toDateTime(__hdx_time_bucket2), toIntervalSecond(15)) AS __hdx_time_bucket FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY __hdx_time_bucket ORDER BY __hdx_time_bucket ASC LIMIT _CAST(100000, 'Int32') 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.namespace.phase')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalSecond(15)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT last_value(toFloat64OrDefault(toString(LastValue))) AS `last_value(k8s.namespace.phase)`, ResourceAttributes['k8s.namespace.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.namespace.name'] 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.pod.cpu.utilization')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalSecond(15)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT sum(toFloat64OrDefault(toString(LastValue))) AS `sum(k8s.pod.cpu.utilization)`, ResourceAttributes['k8s.namespace.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.namespace.name'] 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash FROM otel_v2.otel_metrics_gauge WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.pod.memory.usage')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalSecond(15)) AS __hdx_time_bucket2, AttributesHash, last_value(Value) AS LastValue, any(ScopeAttributes) AS ScopeAttributes, any(ResourceAttributes) AS ResourceAttributes, any(Attributes) AS Attributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT sum(toFloat64OrDefault(toString(LastValue))) AS `sum(k8s.pod.memory.usage)`, ResourceAttributes['k8s.namespace.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.namespace.name'] 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash, IF(AggregationTemporality = 1, SUM(Value) OVER (PARTITION BY AttributesHash ORDER BY AttributesHash ASC, TimeUnix ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), deltaSum(Value) OVER (PARTITION BY AttributesHash ORDER BY AttributesHash ASC, TimeUnix ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)) AS Rate, IF(AggregationTemporality = 1, Rate, Value) AS Sum FROM otel_v2.otel_metrics_sum WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.node.uptime')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Source.Rate) AS __hdx_value_high, any(__hdx_value_high) OVER (PARTITION BY AttributesHash ORDER BY __hdx_time_bucket2 ASC ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) AS __hdx_value_high_prev, __hdx_value_high - __hdx_value_high_prev AS Rate, last_value(Source.Sum) AS Sum, any(ResourceAttributes) AS ResourceAttributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeAttributes) AS ScopeAttributes, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricName) AS MetricName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(Attributes) AS Attributes, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags, any(AggregationTemporality) AS AggregationTemporality, any(IsMonotonic) AS IsMonotonic FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT last_value(Sum) AS `undefined(k8s.node.uptime)`, ResourceAttributes['k8s.node.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.node.name'] 
WITH Source AS (SELECT *, cityHash64(mapConcat(ScopeAttributes, ResourceAttributes, Attributes)) AS AttributesHash, IF(AggregationTemporality = 1, SUM(Value) OVER (PARTITION BY AttributesHash ORDER BY AttributesHash ASC, TimeUnix ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), deltaSum(Value) OVER (PARTITION BY AttributesHash ORDER BY AttributesHash ASC, TimeUnix ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)) AS Rate, IF(AggregationTemporality = 1, Rate, Value) AS Sum FROM otel_v2.otel_metrics_sum WHERE ((TimeUnix >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (TimeUnix <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64')))) AND (MetricName = 'k8s.pod.uptime')), Bucketed AS (SELECT toStartOfInterval(toDateTime(TimeUnix), toIntervalMinute(1)) AS __hdx_time_bucket2, AttributesHash, last_value(Source.Rate) AS __hdx_value_high, any(__hdx_value_high) OVER (PARTITION BY AttributesHash ORDER BY __hdx_time_bucket2 ASC ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) AS __hdx_value_high_prev, __hdx_value_high - __hdx_value_high_prev AS Rate, last_value(Source.Sum) AS Sum, any(ResourceAttributes) AS ResourceAttributes, any(ResourceSchemaUrl) AS ResourceSchemaUrl, any(ScopeName) AS ScopeName, any(ScopeVersion) AS ScopeVersion, any(ScopeAttributes) AS ScopeAttributes, any(ScopeDroppedAttrCount) AS ScopeDroppedAttrCount, any(ScopeSchemaUrl) AS ScopeSchemaUrl, any(ServiceName) AS ServiceName, any(MetricName) AS MetricName, any(MetricDescription) AS MetricDescription, any(MetricUnit) AS MetricUnit, any(Attributes) AS Attributes, any(StartTimeUnix) AS StartTimeUnix, any(Flags) AS Flags, any(AggregationTemporality) AS AggregationTemporality, any(IsMonotonic) AS IsMonotonic FROM Source GROUP BY AttributesHash, __hdx_time_bucket2 ORDER BY AttributesHash ASC, __hdx_time_bucket2 ASC) SELECT last_value(Sum) AS `undefined(k8s.pod.uptime)`, ResourceAttributes['k8s.pod.name'], ResourceAttributes['k8s.namespace.name'], ResourceAttributes['k8s.node.name'] FROM Bucketed WHERE (__hdx_time_bucket2 >= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_START:Int64}, 'Int64'))) AND (__hdx_time_bucket2 <= fromUnixTimestamp64Milli(_CAST({HYPERDX_PARAM_TS_END:Int64}, 'Int64'))) GROUP BY ResourceAttributes['k8s.pod.name'], ResourceAttributes['k8s.namespace.name'], ResourceAttributes['k8s.node.name'] 
