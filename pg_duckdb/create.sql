CREATE VIEW hits AS
SELECT
        r['WatchID']::BIGINT AS WatchID,
        r['JavaEnable']::SMALLINT AS JavaEnable,
        r['Title']::VARCHAR AS Title,
        r['GoodEvent']::SMALLINT AS GoodEvent,
        'epoch'::timestamp + (r['EventTime'] || 'second')::interval AS EventTime,
        'epoch'::timestamp + (r['EventDate'] || 'day')::interval AS EventDate,
        r['CounterID']::INTEGER AS CounterID,
        r['ClientIP']::INTEGER AS ClientIP,
        r['RegionID']::INTEGER AS RegionID,
        r['UserID']::BIGINT AS UserID,
        r['CounterClass']::SMALLINT AS CounterClass,
        r['OS']::SMALLINT AS OS,
        r['UserAgent']::SMALLINT AS UserAgent,
        r['URL']::VARCHAR AS URL,
        r['Referer']::VARCHAR AS Referer,
        r['IsRefresh']::SMALLINT AS IsRefresh,
        r['RefererCategoryID']::SMALLINT AS RefererCategoryID,
        r['RefererRegionID']::INTEGER AS RefererRegionID,
        r['URLCategoryID']::SMALLINT AS URLCategoryID,
        r['URLRegionID']::INTEGER AS URLRegionID,
        r['ResolutionWidth']::SMALLINT AS ResolutionWidth,
        r['ResolutionHeight']::SMALLINT AS ResolutionHeight,
        r['ResolutionDepth']::SMALLINT AS ResolutionDepth,
        r['FlashMajor']::SMALLINT AS FlashMajor,
        r['FlashMinor']::SMALLINT AS FlashMinor,
        r['FlashMinor2']::VARCHAR AS FlashMinor2,
        r['NetMajor']::SMALLINT AS NetMajor,
        r['NetMinor']::SMALLINT AS NetMinor,
        r['UserAgentMajor']::SMALLINT AS UserAgentMajor,
        r['UserAgentMinor']::VARCHAR AS UserAgentMinor,
        r['CookieEnable']::SMALLINT AS CookieEnable,
        r['JavascriptEnable']::SMALLINT AS JavascriptEnable,
        r['IsMobile']::SMALLINT AS IsMobile,
        r['MobilePhone']::SMALLINT AS MobilePhone,
        r['MobilePhoneModel']::VARCHAR AS MobilePhoneModel,
        r['Params']::VARCHAR AS Params,
        r['IPNetworkID']::INTEGER AS IPNetworkID,
        r['TraficSourceID']::SMALLINT AS TraficSourceID,
        r['SearchEngineID']::SMALLINT AS SearchEngineID,
        r['SearchPhrase']::VARCHAR AS SearchPhrase,
        r['AdvEngineID']::SMALLINT AS AdvEngineID,
        r['IsArtifical']::SMALLINT AS IsArtifical,
        r['WindowClientWidth']::SMALLINT AS WindowClientWidth,
        r['WindowClientHeight']::SMALLINT AS WindowClientHeight,
        r['ClientTimeZone']::SMALLINT AS ClientTimeZone,
        'epoch'::timestamp + (r['ClientEventTime'] || 'second')::interval AS ClientEventTime,
        r['SilverlightVersion1']::SMALLINT AS SilverlightVersion1,
        r['SilverlightVersion2']::SMALLINT AS SilverlightVersion2,
        r['SilverlightVersion3']::INTEGER AS SilverlightVersion3,
        r['SilverlightVersion4']::SMALLINT AS SilverlightVersion4,
        r['PageCharset']::VARCHAR AS PageCharset,
        r['CodeVersion']::INTEGER AS CodeVersion,
        r['IsLink']::SMALLINT AS IsLink,
        r['IsDownload']::SMALLINT AS IsDownload,
        r['IsNotBounce']::SMALLINT AS IsNotBounce,
        r['FUniqID']::BIGINT AS FUniqID,
        r['OriginalURL']::VARCHAR AS OriginalURL,
        r['HID']::INTEGER AS HID,
        r['IsOldCounter']::SMALLINT AS IsOldCounter,
        r['IsEvent']::SMALLINT AS IsEvent,
        r['IsParameter']::SMALLINT AS IsParameter,
        r['DontCountHits']::SMALLINT AS DontCountHits,
        r['WithHash']::SMALLINT AS WithHash,
        r['HitColor']::VARCHAR AS HitColor,
        'epoch'::timestamp + (r['LocalEventTime'] || 'second')::interval AS LocalEventTime,
        r['Age']::SMALLINT AS Age,
        r['Sex']::SMALLINT AS Sex,
        r['Income']::SMALLINT AS Income,
        r['Interests']::SMALLINT AS Interests,
        r['Robotness']::SMALLINT AS Robotness,
        r['RemoteIP']::INTEGER AS RemoteIP,
        r['WindowName']::INTEGER AS WindowName,
        r['OpenerName']::INTEGER AS OpenerName,
        r['HistoryLength']::SMALLINT AS HistoryLength,
        r['BrowserLanguage']::VARCHAR AS BrowserLanguage,
        r['BrowserCountry']::VARCHAR AS BrowserCountry,
        r['SocialNetwork']::VARCHAR AS SocialNetwork,
        r['SocialAction']::VARCHAR AS SocialAction,
        r['HTTPError']::SMALLINT AS HTTPError,
        r['SendTiming']::INTEGER AS SendTiming,
        r['DNSTiming']::INTEGER AS DNSTiming,
        r['ConnectTiming']::INTEGER AS ConnectTiming,
        r['ResponseStartTiming']::INTEGER AS ResponseStartTiming,
        r['ResponseEndTiming']::INTEGER AS ResponseEndTiming,
        r['FetchTiming']::INTEGER AS FetchTiming,
        r['SocialSourceNetworkID']::SMALLINT AS SocialSourceNetworkID,
        r['SocialSourcePage']::VARCHAR AS SocialSourcePage,
        r['ParamPrice']::BIGINT AS ParamPrice,
        r['ParamOrderID']::VARCHAR AS ParamOrderID,
        r['ParamCurrency']::VARCHAR AS ParamCurrency,
        r['ParamCurrencyID']::SMALLINT AS ParamCurrencyID,
        r['OpenstatServiceName']::VARCHAR AS OpenstatServiceName,
        r['OpenstatCampaignID']::VARCHAR AS OpenstatCampaignID,
        r['OpenstatAdID']::VARCHAR AS OpenstatAdID,
        r['OpenstatSourceID']::VARCHAR AS OpenstatSourceID,
        r['UTMSource']::VARCHAR AS UTMSource,
        r['UTMMedium']::VARCHAR AS UTMMedium,
        r['UTMCampaign']::VARCHAR AS UTMCampaign,
        r['UTMContent']::VARCHAR AS UTMContent,
        r['UTMTerm']::VARCHAR AS UTMTerm,
        r['FromTag']::VARCHAR AS FromTag,
        r['HasGCLID']::SMALLINT AS HasGCLID,
        r['RefererHash']::BIGINT AS RefererHash,
        r['URLHash']::BIGINT AS URLHash,
        r['CLID']::INTEGER AS CLID
FROM read_parquet('/tmp/hits.parquet') AS r;
